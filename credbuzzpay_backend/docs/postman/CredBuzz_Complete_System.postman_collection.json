{
  "info": {
    "name": "CredBuzz Complete System APIs",
    "description": "All APIs for Authentication, KYC, RBAC, User Management, and Access Control",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {"key": "base_url", "value": "http://127.0.0.1:8000/api"},
    {"key": "access_token", "value": ""},
    {"key": "refresh_token", "value": ""},
    {"key": "user_id", "value": "1"}
  ],
  "auth": {
    "type": "bearer",
    "bearer": [{"key": "token", "value": "{{access_token}}", "type": "string"}]
  },
  "item": [
    {
      "name": "1. Authentication",
      "item": [
        {
          "name": "Register User",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"newuser@example.com\",\n    \"phone_number\": \"9876543210\",\n    \"password\": \"SecurePass@123\",\n    \"confirm_password\": \"SecurePass@123\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}"
            },
            "url": "{{base_url}}/auth-user/register/"
          }
        },
        {
          "name": "Verify Registration OTP",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"newuser@example.com\",\n    \"otp\": \"123456\"\n}"
            },
            "url": "{{base_url}}/auth-user/verify-registration-otp/"
          }
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.data && jsonData.data.tokens) {",
                  "    pm.collectionVariables.set('access_token', jsonData.data.tokens.access_token);",
                  "    pm.collectionVariables.set('refresh_token', jsonData.data.tokens.refresh_token);",
                  "    console.log('Tokens saved!');",
                  "    console.log('User Role:', jsonData.data.user.user_role);",
                  "    console.log('KYC Status:', jsonData.data.kyc_status.status);",
                  "    console.log('App Access:', jsonData.data.app_access);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"identifier\": \"admin@credbuzz.com\",\n    \"password\": \"your_password\"\n}"
            },
            "url": "{{base_url}}/auth-user/login/"
          }
        },
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/profile/"
          }
        },
        {
          "name": "Get Profile with Full Access Info",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/profile-full/"
          }
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"refresh_token\": \"{{refresh_token}}\"\n}"
            },
            "url": "{{base_url}}/auth-user/refresh-token/"
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth-user/logout/"
          }
        },
        {
          "name": "Change Password",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"current_password\": \"old_password\",\n    \"new_password\": \"NewSecurePass@123\",\n    \"confirm_password\": \"NewSecurePass@123\"\n}"
            },
            "url": "{{base_url}}/auth-user/change-password/"
          }
        }
      ]
    },
    {
      "name": "2. User Management (Admin)",
      "item": [
        {
          "name": "List All Users",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/users/"
          }
        },
        {
          "name": "List Users by Role",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/users/?role=CLIENT"
          }
        },
        {
          "name": "Get User Details",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/users/{{user_id}}/"
          }
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"first_name\": \"Updated Name\",\n    \"is_active\": true\n}"
            },
            "url": "{{base_url}}/auth-user/users/{{user_id}}/"
          }
        },
        {
          "name": "Activate User",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/auth-user/users/{{user_id}}/activate/"
          }
        },
        {
          "name": "Deactivate User",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/auth-user/users/{{user_id}}/deactivate/"
          }
        },
        {
          "name": "Soft Delete User",
          "request": {
            "method": "DELETE",
            "url": "{{base_url}}/auth-user/users/{{user_id}}/"
          }
        },
        {
          "name": "Restore Deleted User",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth-user/users/{{user_id}}/restore/"
          }
        }
      ]
    },
    {
      "name": "3. KYC - User Flow",
      "item": [
        {
          "name": "Get KYC Status",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/kyc/status/"
          }
        },
        {
          "name": "Start KYC",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/kyc/start/"
          }
        },
        {
          "name": "Submit Aadhaar Details",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"aadhaar_number\": \"123456789012\",\n    \"full_name\": \"John Doe\",\n    \"date_of_birth\": \"1990-01-15\",\n    \"gender\": \"MALE\",\n    \"address\": \"123 Main Street, Mumbai, Maharashtra 400001\"\n}"
            },
            "url": "{{base_url}}/kyc/identity/aadhaar/"
          }
        },
        {
          "name": "Upload Aadhaar Images",
          "request": {
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "aadhaar_front", "type": "file", "src": ""},
                {"key": "aadhaar_back", "type": "file", "src": ""}
              ]
            },
            "url": "{{base_url}}/kyc/identity/aadhaar/upload/"
          }
        },
        {
          "name": "Submit PAN Details",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"pan_number\": \"ABCDE1234F\",\n    \"name_on_pan\": \"JOHN DOE\"\n}"
            },
            "url": "{{base_url}}/kyc/identity/pan/"
          }
        },
        {
          "name": "Submit Business Details",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"business_name\": \"John Electronics\",\n    \"business_type\": \"RETAIL\",\n    \"gst_number\": \"22AAAAA0000A1Z5\",\n    \"business_address\": \"456 Shop Street, Mumbai\"\n}"
            },
            "url": "{{base_url}}/kyc/business/"
          }
        },
        {
          "name": "Upload Selfie",
          "request": {
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [{"key": "selfie", "type": "file", "src": ""}]
            },
            "url": "{{base_url}}/kyc/verification/selfie/"
          }
        },
        {
          "name": "Upload Office Photos",
          "request": {
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [
                {"key": "inside_photo", "type": "file", "src": ""},
                {"key": "outside_photo", "type": "file", "src": ""}
              ]
            },
            "url": "{{base_url}}/kyc/verification/office/"
          }
        },
        {
          "name": "Submit Bank Details",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"account_holder_name\": \"John Doe\",\n    \"account_number\": \"123456789012\",\n    \"ifsc_code\": \"SBIN0001234\",\n    \"bank_name\": \"State Bank of India\"\n}"
            },
            "url": "{{base_url}}/kyc/bank/"
          }
        },
        {
          "name": "Submit KYC for Review",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/kyc/submit/"
          }
        },
        {
          "name": "Get Full KYC Details",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/kyc/detail/"
          }
        }
      ]
    },
    {
      "name": "4. KYC - Admin Review",
      "item": [
        {
          "name": "List KYC Applications",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/kyc/admin/applications/"
          }
        },
        {
          "name": "List Submitted Applications",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/kyc/admin/applications/?status=SUBMITTED"
          }
        },
        {
          "name": "Get Application Details",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/kyc/admin/applications/KYC20251210001/"
          }
        },
        {
          "name": "Start Review",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/kyc/admin/applications/KYC20251210001/start-review/"
          }
        },
        {
          "name": "Approve Application",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"action\": \"APPROVE\",\n    \"remarks\": \"All documents verified successfully\"\n}"
            },
            "url": "{{base_url}}/kyc/admin/applications/KYC20251210001/review/"
          }
        },
        {
          "name": "Reject Application",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"action\": \"REJECT\",\n    \"remarks\": \"PAN number mismatch with Aadhaar name\"\n}"
            },
            "url": "{{base_url}}/kyc/admin/applications/KYC20251210001/review/"
          }
        }
      ]
    },
    {
      "name": "5. RBAC - Roles & Permissions",
      "item": [
        {
          "name": "Initialize Default Roles",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/rbac/roles/initialize/"
          }
        },
        {
          "name": "List All Roles",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/roles/"
          }
        },
        {
          "name": "Get Role Details",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/roles/1/"
          }
        },
        {
          "name": "Create Role",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"CUSTOM_ROLE\",\n    \"description\": \"Custom role with limited access\",\n    \"level\": 4,\n    \"is_system_role\": false\n}"
            },
            "url": "{{base_url}}/rbac/roles/"
          }
        }
      ]
    },
    {
      "name": "6. RBAC - Apps & Features",
      "item": [
        {
          "name": "List All Apps",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/apps/"
          }
        },
        {
          "name": "Create App",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"New Module\",\n    \"code\": \"NEW_MODULE\",\n    \"description\": \"A new system module\",\n    \"display_order\": 10,\n    \"is_active\": true\n}"
            },
            "url": "{{base_url}}/rbac/apps/"
          }
        },
        {
          "name": "List All Features",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/features/"
          }
        },
        {
          "name": "List Features by App",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/features/?app_id=1"
          }
        },
        {
          "name": "Create Feature",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"app\": 1,\n    \"name\": \"Export Reports\",\n    \"code\": \"EXPORT_REPORTS\",\n    \"description\": \"Export data to CSV/Excel\",\n    \"is_active\": true\n}"
            },
            "url": "{{base_url}}/rbac/features/"
          }
        },
        {
          "name": "Get All Apps with Features",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/all-access-items/"
          }
        }
      ]
    },
    {
      "name": "7. RBAC - User Access",
      "item": [
        {
          "name": "Get My Permissions",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/my-permissions/"
          }
        },
        {
          "name": "Check Permission",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"app_code\": \"BILL_PAY\",\n    \"feature_code\": \"PAY_BILLS\"\n}"
            },
            "url": "{{base_url}}/rbac/check-permission/"
          }
        },
        {
          "name": "Get User Access Overview",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/users/{{user_id}}/access/"
          }
        },
        {
          "name": "Assign Access to User",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"role_id\": 3,\n    \"app_ids\": [1, 2, 3],\n    \"feature_ids\": [1, 2, 3, 4, 5]\n}"
            },
            "url": "{{base_url}}/rbac/users/{{user_id}}/assign-access/"
          }
        },
        {
          "name": "Revoke Access from User",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"app_ids\": [2],\n    \"feature_ids\": [4, 5]\n}"
            },
            "url": "{{base_url}}/rbac/users/{{user_id}}/revoke-access/"
          }
        }
      ]
    },
    {
      "name": "8. RBAC - Role Assignments",
      "item": [
        {
          "name": "List Role Assignments",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/user-role-assignments/"
          }
        },
        {
          "name": "Assign Role to User",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"user\": 5,\n    \"role\": 3,\n    \"is_active\": true\n}"
            },
            "url": "{{base_url}}/rbac/user-role-assignments/"
          }
        },
        {
          "name": "Update Role Assignment",
          "request": {
            "method": "PUT",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"is_active\": false\n}"
            },
            "url": "{{base_url}}/rbac/user-role-assignments/1/"
          }
        },
        {
          "name": "Bulk Assign Apps to Role",
          "request": {
            "method": "POST",
            "header": [{"key": "Content-Type", "value": "application/json"}],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"role_id\": 3,\n    \"app_ids\": [1, 2, 3, 4]\n}"
            },
            "url": "{{base_url}}/rbac/role-app-mappings/bulk/"
          }
        }
      ]
    },
    {
      "name": "9. Audit Logs",
      "item": [
        {
          "name": "Get RBAC Audit Logs",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/rbac/audit-logs/"
          }
        },
        {
          "name": "Get User Activity Logs",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/activity-logs/"
          }
        },
        {
          "name": "Get My Activity",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth-user/my-activity/"
          }
        }
      ]
    }
  ]
}
